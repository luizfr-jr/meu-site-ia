{% extends 'base.html' %}

{% block title %}Home Inteligente - Meu Site IA{% endblock %}

{% block content %}
  <h1 class="text-center mb-4">🤖 Bem-vindo ao <strong>Meu Site IA</strong></h1>
  <p class="text-center text-muted mb-5">💡 Explore, aprenda e transforme sua rotina com as melhores ferramentas de IA focadas na educação e colaboração em comunidade!</p>

  <!-- IA Mais Usada da Semana -->
  <section class="mb-5">
    <h2>🔥 IA Mais Usada da Semana</h2>
    <div class="card shadow-sm p-4">
      <h3>{{ ia_mais_usada.nome }}</h3>
      <p>{{ ia_mais_usada.descricao }}</p>
      {% if ia_mais_usada.acessos_semana %}
        <small class="text-muted">Acessos nesta semana: {{ ia_mais_usada.acessos_semana }}</small><br>
      {% endif %}
      <a href="{{ ia_mais_usada.link }}" class="btn btn-primary mt-3" target="_blank" rel="noopener">Testar Agora</a>
    </div>
  </section>

  <!-- Recomendação Inteligente -->
  <section class="mb-5">
    <h2>🎯 Recomendação Inteligente</h2>
    <div class="card shadow-sm p-4">
      <h3>{{ ia_recomendada.nome }}</h3>
      <p>{{ ia_recomendada.descricao }}</p>
      <a href="{{ ia_recomendada.link }}" class="btn btn-success mt-3" target="_blank" rel="noopener">Experimente</a>
    </div>
  </section>

  <!-- Top 5 Ferramentas Mais Acessadas -->
<section class="mb-5">
    <h2>🏆 Top 5 Ferramentas Mais Acessadas</h2>
    <ul class="list-group">
      {% for ia in top_5 %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <span class="fw-bold">{{ loop.index }}. {{ ia.nome }}</span><br>
            <small class="text-muted">{{ ia.descricao[:80] }}{% if ia.descricao|length > 80 %}...{% endif %}</small>
          </div>
          <div class="text-end">
            <span class="badge bg-primary rounded-pill">{{ ia.acessos_totais or 0 }} cliques</span><br>
            <a href="{{ url_for('acessar_ferramenta', ferramenta_id=ia['id']) }}" class="btn btn-sm btn-outline-primary mt-2">Acessar</a>
          </div>
        </li>
      {% else %}
        <li class="list-group-item text-muted">Nenhuma ferramenta cadastrada ainda.</li>
      {% endfor %}
    </ul>
  </section>

  <!-- Ferramenta Aleatória -->
  <section class="mb-5">
    <h2>🎲 Me Surpreenda!</h2>
    <div class="card shadow-sm p-4">
      <h3>{{ ia_aleatoria.nome }}</h3>
      <p>{{ ia_aleatoria.descricao }}</p>
      <a href="{{ ia_aleatoria.link }}" class="btn btn-warning mt-3" target="_blank" rel="noopener">Tentar Agora</a>
    </div>
  </section>

  <!-- Comunidade e Fórum -->
  <section class="mb-5">
    <h2>💬 Comunidade Ativa</h2>
    <p>Participe do nosso fórum, troque ideias, compartilhe experiências e evolua com outros usuários!</p>
    <div class="row">
      <div class="col-md-6 mb-3">
        <div class="card shadow-sm p-3 h-100">
          <h5 class="card-title">📢 Últimos Tópicos</h5>
          <ul class="list-group list-group-flush">
            {% for t in topicos_recentes[:5] %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <a href="/forum/topico/{{ t.id }}" class="text-decoration-none">{{ t.titulo[:40] }}{% if t.titulo|length > 40 %}...{% endif %}</a>
                <small class="text-muted">{{ t.data_criacao.strftime('%d/%m') }}</small>
              </li>
            {% else %}
              <li class="list-group-item text-muted">Nenhum tópico recente.</li>
            {% endfor %}
          </ul>
          <a href="/forum" class="btn btn-outline-primary mt-3">Entrar no Fórum</a>
        </div>
      </div>

      <div class="col-md-6 mb-3">
        <div class="card shadow-sm p-3 h-100">
          <h5 class="card-title">🏅 Usuários em Destaque</h5>
          <ul class="list-group list-group-flush">
            {% for u in ranking[:5] %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <a href="/usuario/{{ u.id }}" class="fw-bold text-dark text-decoration-none">{{ u.nome }}</a>
                <span class="badge bg-success">{{ u.pontos }} pts</span>
              </li>
            {% else %}
              <li class="list-group-item text-muted">Nenhum usuário em destaque.</li>
            {% endfor %}
          </ul>
          <a href="/ranking" class="btn btn-outline-success mt-3">Ver Ranking Completo</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Notícia do Dia -->
  <section class="mb-5">
    <h2>📰 Notícia do Dia</h2>
    {% if noticia %}
      <div class="card shadow-sm p-4">
        {% if noticia.image %}
          <img src="{{ noticia.image }}" alt="Imagem da notícia" class="img-fluid mb-3 rounded w-100" style="max-height: 250px; object-fit: cover;">
        {% endif %}
        <h4 class="mb-2">{{ noticia.title }}</h4>
        <p class="mb-3">{{ noticia.description }}</p>
        <a href="{{ noticia.url }}" target="_blank" class="btn btn-outline-primary" rel="noopener">Ler na íntegra</a>
        <p class="mt-3 text-muted"><small>Fonte: {{ noticia.source }}</small></p>
      </div>
    {% else %}
      <div class="alert alert-warning text-center">
        Nenhuma notícia disponível no momento. Tente novamente mais tarde.
      </div>
    {% endif %}
  </section>

  <!-- Dica da Semana -->
  <section class="mb-5">
    <h2>✨ Dica da Semana</h2>
    <div class="alert alert-info fs-5">
      {{ dica }}
    </div>
  </section>
{% endblock %}